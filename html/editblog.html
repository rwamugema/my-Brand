<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/editblog.css">
    <link rel="website icon" href="image/logo.png" />
    <title>editblog</title>
</head>
<body>
    <main>
        <div class="nav-bar">
            <img src="image/logo.png" alt="">
            <a href="">
              logout
            </a>
        </div>
    </main>
    <div class="container">
        <h1>edit post</h1>
        <p id="errorMessage"></p>
        <label for="title">
            post title:
        </label>
        <input type="text" id="title">
        <label for="category">category</label>
        <input type="text" id="category">
        <label for="postcontent">post content:</label>
        <textarea name="postContent" id="content" cols="30" rows="10"></textarea>
        <label for="image" >post image:</label>
        <input type="file" id="image">
        <button id="btn" onclick="updatePost()">update</button>
</div>
<script>
    
    async function updatePost(){  
        let token = localStorage.getItem('token')
        const  urlParams = new URL(window.location).searchParams;
        const  nameId =urlParams.get("_id")
        const blog = {
              title: document.getElementById("title").value,
              category: document.getElementById('category').value,
              content: document.getElementById("content").value,
              image: document.getElementById('image').files[0]
        }   
        const options = {
            method:'PATCH',
            headers:{
                Authorization: `bearer ${token}`,
                'content-type':'application/json'
            },
            body: JSON.stringify(blog)
        }
        try {
            const response = await fetch(`https://naughty-jay-tank-top.cyclic.app/api/v1/blogs/${nameId}`,options)
            const data = await response.json()
        } catch(error){
            errorMessage.innerHTML = error.message
        }
    }
   
    
   
</script>
</body>
</html>