<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" -->
    
    <link rel="stylesheet" href="css/singleblog.css" />
     <link rel="website icon" href="image/logo.png" />
    <title>blog</title>
  </head>
  <body>
    <main class="nav-bar">
      <div id="nav-img">
        <img src="image/logo.png" alt="#" />
      </div>
      <div class="topnav">
        <div id="menu">
          <li style="--i: 0"><a href="#">science</a></li>
          <li style="--i: 1"><a href="#">nature</a></li>
          <li style="--i: 2"><a href="#">football</a></li>
          <li style="--i: 3"><a href="#">movies</a></li>
        </div>
        <a href="javascript:void(0);" class="icon" onclick="myFunction()">
          <i class="fa fa-bars"></i
        ></a>
      </div>
    </main>
    <!-- section part start -->
    <section>
    <div>
      <div class="ftb">
      </div>
      <div class="comment">
        <div id="display-comment">
          <h3>comments</h3>
        </div>
        <h5>add comment</h5>
        <div id="add-comment">
        </div>
      </div>
      <div id="error">Your name or comment can not be empty</div>
    </div>
  </section>
    <!-- section part end -->
    <footer>
      <div id="copy">
        <p>&copy /2022</p>
        <hr />
      </div>
      <div id="icons">
        <a href="https://github.com/rwamugema"> <i class="fa fa-github"></i></a>
        <a href="https://www.linkedin.com/in/rwamugema-japhet-84818b251/"
          ><i class="fa fa-linkedin"></i
        ></a>
        <a href="https://www.facebook.com/jet.japheth"
          ><i class="fa fa-facebook"></i
        ></a>
      </div>
    </footer>
    <script>
      //function to manage the humberg button
      function myFunction() {
        var x = document.getElementById("menu");
        if (x.style.display === "block") {
          x.style.display = "none";
        } else {
          x.style.display = "block";
        }
      }
      const  userName= document.querySelector("#input")
       const  userComment= document.querySelector("comments")
      //function to append the name and comment of a user
      function validateComment() {
        let articles =JSON.parse(localStorage.getItem("article"))
        var comments = [];
        let comment = {
          id: Date.now(),
          userName: document.getElementsByName("name")[0].value,
          userComment: document.getElementsByName("comment")[0].value,
          articleid:post.id
        };
        // check user inputs
        if (!comment.userName) {
          error.style.display = "block";
          error.innerHTML = "your name can not be empty";
        } else if (comment.userName.length < 5) {
          error.style.display = "block";
          error.innerHTML = "check your name it might be wrong";
        } else if (!comment.userComment) {
          error.style.display = "block";
          error.innerHTML = "comment is required";
        } else if (comment.userComment.length < 5) {
          error.style.display = "block";
          error.style.display = "comment is short try 5 words ";
        } else {
          if (localStorage.getItem("comment") === null) {
            comments.push(comment);
            localStorage.setItem("comment", JSON.stringify(comments));
            location.reload()
          } else {
            let stored = JSON.parse(localStorage.getItem("comment"));
            stored.push(comment);
            localStorage.setItem("comment", JSON.stringify(stored));
            location.reload()
          }
        }

      }
// get single blog from the localstorage
//Get ID of single blog after click on read More button
         const date =new Date();
         let day = date.getDate();
         let month = date.getMonth() + 1;
         let year = date.getFullYear();
         const urlParams = new URL(window.location).searchParams;
         const nameId = urlParams.get("id");
         let articles = JSON.parse(localStorage.getItem("article"));
         let comments=JSON.parse(localStorage.getItem('comment'));
         let comment= comments.filter((e)=>e.articleid == nameId)
         let post = articles.find((e)=> e.id == nameId)
//function call
         displayFullBlog();
// Display full blog after getting it in local storage
         function displayFullBlog() {
  let section = document.querySelector(".ftb");
  let displayPost= document.createElement('div')
  displayPost.innerHTML = `
  <div class="ftb">
    <div id="head">
    <h2>${post.postTitle}</h2>
    </div>
    <div class="cont-ner">
  <img src="${post.image}" alt="" class="article-image" />
  <div id="contents">
    <p>${post.textarea}</p>
    </div>
    </div>
  </div>
  `
  section.append(displayPost);
          comment.forEach(c => {
          let commentss = document.querySelector("#display-comment")
          let displayComment = document.createElement('div')
          displayComment.innerHTML=` 
           <span>${c.userName}    .${day}/${month}</span>
           <p>${c.userComment}</p>
          </div>
           `
        commentss.append(displayComment)
});

//add comment form

let commentPost = document.querySelector("#add-comment")
 let addComment = document.createElement('div')
 addComment.innerHTML =`
            <input type="text" name="name" id="input" placeholder="your name" />
            <input
              type="text"
              name="comment"
              id="comments"
              placeholder="add comment"
            />
            <button onclick="validateComment()">comment</button>
          </div>
            `
            commentPost.append(addComment)
            }
    </script>
  </body>
</html>
