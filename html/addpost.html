<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
  <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
  <link
      href="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.css"
      rel="stylesheet"
    /> 
     <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.18/dist/summernote-lite.min.js">

    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet"href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link rel="stylesheet" href="css/addpost.css" />
    <link rel="website icon" href="image/logo.png">
    <title>add post</title>
</head>
<body>
  <!-- navigation bar starts -->
    <main class="nav-bar">
        <div id="dashboard">
          <img src="image/logo.png" alt="#"  />
          <h1>dashboard</h1>

        </div>
          <div class="topnav">
            <div id="menu">
          <div class="inputContainer">
          <i class="fa fa-search icon"></i>
          <input type="search" name="search" id="field" placeholder="search...">
        </div>
            <div id="name">
              <img src="image/profile.jpg" alt="Japhet">
                <p>rwamugema Japhet</p>
            </div>
            <div id="logout">
                <a href="#">log out</a>
            </div>
        </div>
              <a href="javascript:void(0);" class="icon" onclick="myFunction()">
                 <i class class="fa fa-bars"></i>Menu
                </a>
        </div>
    </main>
    <!-- navigation bar ends -->
    <!-- footer starts -->
    <footer>
        <div class="footer">
          <div id="footer">
          <p><a href="blogoverview.html">overview</a></p>
          <p><a href="user.html">queries</a></p>
          <p><a href="post.html">post</a></p>
          <p><a href="article.html">article</a></p>
          </a>
        </div>
        </div>
        <div class="box">
            <div class="box-1">
           <h2>add new post</h2>
           <div id="input">
            <div id="error"></div>
            <h3>post title</h3>
            <input type="text" name="name" class="input" placeholder="">
            <h3>category</h3>
            <input type="text" name="category" id="category">
          <!-- text editor -->
            <h3>post content</h3>
            <textarea name="textarea" id="summernote"  cols="30" rows="10"></textarea>
            <h3>post photo</h3>
            <input type="file" name="image" id="image">
            <button id='jet' onclick="validatePost()">publish</button>
           </div>
        </div>
        </div>

    </footer>
    <!-- footer ends -->
    <!-- js scripting -->
    <script>
        function myFunction() {
          var x = document.getElementById("menu");
          if (x.style.display === "block") {
            x.style.display = "none";
          } else {
            x.style.display = "block";
          }
        }

              $("#summernote").summernote({

                placeholder: "blog content here...",
                 FontNames:['poppins','sans serif','Arial'],
                 height: 50,
                 shorrtcuts:false,
                toolbar: [
                  ["style", ["style"]],
                  ["font", ["bold", "underline", "clear"]],
                  ["color", ["color"]],
                  ["para", ["ul", "ol", "paragraph"]],
                  ["table", ["table"]],
                  ["insert", ["link", "picture", "video"]],
                  ["view", ["fullscreen", "codeview", "help"]],
                ],
                            });
               // a method to validate the add post page
     const toBase64 = file => new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
});
    //  async function validatePost(){
   
    //   let convert=await toBase64(imgv)
    
    //   let article ={
    //        postTitle:PostTitle,
    //        textarea:TextArea,
    //        category:Category,
    //        image:convert,
    //        comment:[]
    // };
   
       //read image from the inputs
      //  const imgv=document.getElementById('image')
      //  const image=imgv.files[0]
      //  const fr=new FileReader();
      //   fr.readAsDataURL(image);
      //  if (!image) {
      //    error.style.display='block'
      //    error.innerHTML ='image is required'
          //convert image into a url
     
    //check if inputd are not empty or meet required length
    // if(article.postTitle ==''){
    //      error.style.display = 'block'
    //    error.innerHTML = 'post title can not be empty'
    //   }else if (article.postTitle.length <10) {
    //      error.style.display ='block'
    //      error.innerHTML ='post title is short try 10 words'
    //   }else if(article.textarea ===''){
    //     error.style.display ='block'
    //      error.innerHTML ='post content can not be empty'
    //    }else if (article.textarea.length <30) {
    //      error.style.display ='block'
    //      error.innerHTML ='post content size is too short try 30 words'
    //    }else if (!article.category) {
    //     error.style.display ='block'
    //      error.innerHTML ='category is required'
    //    }else if (article.category.length < 5) {
    //    error.style.display ='block'
    //      error.innerHTML ='category name is short'
    //    }
       const image=document.getElementById('image').files[0]
       const title= document.getElementsByName('name')[0].value
      let content = document.getElementsByName('textarea')[0].value
      let category =document.getElementsByName('category')[0].value
    async  function validatePost() {
      // const formData = new FormData()
      // console.log(title);
      //        formData.append("title", title)
      //        formData.append("category",category)
      //        formData.append("content",content )
      //        formData.append( "image",image)
             const response = await fetch('https://naughty-jay-tank-top.cyclic.app/api/v1/blogs',{
              method:'POST',
              mode:'no-cors',
              headers:{
                'content-type':'application/json'
              },
              body: JSON.stringify(formData)
             })
             
          // axios.post("https://naughty-jay-tank-top.cyclic.app/api/v1/blogs", formData,
          //    {"Content-Type": "multipart/form-data",
          //    })
          //    .then((res)=> console.log("response", res))
          //    .catch((error)=>{
          //      console.log("error", error)
          //    })
    }
   
//stored the post on the local storage
// fetch('https://naughty-jay-tank-top.cyclic.app/api/v1/blogs', {
//     method: "POST",
//     mode: "cors",
//     headers: {
//       "Content-Type": "application/json",
//     },
//     body: JSON.stringify(article),
//   })
//     .then((response) => response.json())
//     .then((data) => {
//       console.log(data);
//     })
//     .catch((error) => {
//       console.error("There was a problem with the fetch operation:", error);
//     });
        
    //       let articles=JSON.parse(localStorage.getItem("article")) || []
    //       articles.push({
    //        id:articles.length +1,
    //        postTitle:PostTitle,
    //        textarea:TextArea,
    //        category:Category,
    //        image:convert,
    //        comment:[]
    // })
    // let stored=localStorage.setItem("article",JSON.stringify(articles))
          // saving the infos to the local storage
        //   if (localStorage.getItem("article") === null) {
        //     articles.push(id,PostTitle,TextArea,Category);
        //     localStorage.setItem("article", JSON.stringify(articles));
        //     location.reload();
        //   } else {
        //     let stored = JSON.parse(localStorage.getItem("article"));
        //     stored.push(article);
        //     localStorage.setItem("article", JSON.stringify(stored));
        //     location.reload();
          
        //   }
        // }
      // }
    
  
 </script>
</body>
</html>
